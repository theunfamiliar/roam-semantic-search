‚ñ∂Ô∏è Committing changes to GitHub...
On branch main
nothing to commit, working tree clean
‚ö†Ô∏è Nothing to commit.
Everything up-to-date
üöÄ SSHing into VPS and pulling latest code...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   set -e
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
[?2004l‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üìç Connected to VPS - Starting Deploy"
[?2004lüìç Connected to VPS - Starting Deploy
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ"
[?2004l‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   cd /root/roam-semantic-search
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üîê Ensuring all scripts are executable..."
[?2004lüîê Ensuring all scripts are executable...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   chmod +x ./scripts/*.sh
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üì¶ Forcing latest from GitHub (reset)..."
[?2004lüì¶ Forcing latest from GitHub (reset)...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   git fetch origin
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   git reset --hard origin/main
[?2004lHEAD is now at 935a3bc .
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üß† Checking for server.py..."
[?2004lüß† Checking for server.py...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   if [ ! -f server.py ]; then
[?2004l[?2004h>     echo "‚ùå server.py not found"; exit 1
[?2004l[?2004h>   fi
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üõë Stopping systemd service (semantic-api.service)..."
[?2004lüõë Stopping systemd service (semantic-api.service)...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   systemctl stop semantic-api.service
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üî™ Killing any lingering uvicorn processes..."
[?2004lüî™ Killing any lingering uvicorn processes...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   pkill -f uvicorn || true
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   sleep 2
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üîÑ Verifying port 8000 is free..."
[?2004lüîÑ Verifying port 8000 is free...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   if lsof -i :8000; then
[?2004l[?2004h>     echo "‚ùå Port 8000 still in use!"; exit 1
[?2004l[?2004h>   else
[?2004l[?2004h>     echo "‚úÖ Port 8000 successfully cleared"
[?2004l[?2004h>   fi
[?2004l‚úÖ Port 8000 successfully cleared
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üîÑ Restarting API service..."
[?2004lüîÑ Restarting API service...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   systemctl start semantic-api.service
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "ü™µ Dumping last 30 log lines from semantic-api.service..."
[?2004lü™µ Dumping last 30 log lines from semantic-api.service...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   journalctl -u semantic-api.service -n 30 --no-pager
[?2004lMay 28 18:16:35 vmi2583988 uvicorn[1258312]:     return future.result()
May 28 18:16:35 vmi2583988 uvicorn[1258312]:            ^^^^^^^^^^^^^^^
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "/root/roam-semantic-search/venv/lib/python3.12/site-packages/uvicorn/server.py", line 70, in serve
May 28 18:16:35 vmi2583988 uvicorn[1258312]:     await self._serve(sockets)
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "/root/roam-semantic-search/venv/lib/python3.12/site-packages/uvicorn/server.py", line 77, in _serve
May 28 18:16:35 vmi2583988 uvicorn[1258312]:     config.load()
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "/root/roam-semantic-search/venv/lib/python3.12/site-packages/uvicorn/config.py", line 435, in load
May 28 18:16:35 vmi2583988 uvicorn[1258312]:     self.loaded_app = import_from_string(self.app)
May 28 18:16:35 vmi2583988 uvicorn[1258312]:                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "/root/roam-semantic-search/venv/lib/python3.12/site-packages/uvicorn/importer.py", line 19, in import_from_string
May 28 18:16:35 vmi2583988 uvicorn[1258312]:     module = importlib.import_module(module_str)
May 28 18:16:35 vmi2583988 uvicorn[1258312]:              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "/usr/lib/python3.12/importlib/__init__.py", line 90, in import_module
May 28 18:16:35 vmi2583988 uvicorn[1258312]:     return _bootstrap._gcd_import(name[level:], package, level)
May 28 18:16:35 vmi2583988 uvicorn[1258312]:            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "<frozen importlib._bootstrap_external>", line 995, in exec_module
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
May 28 18:16:35 vmi2583988 uvicorn[1258312]:   File "/root/roam-semantic-search/server.py", line 3, in <module>
May 28 18:16:35 vmi2583988 uvicorn[1258312]:     @app.post("/reindex")
May 28 18:16:35 vmi2583988 uvicorn[1258312]:      ^^^
May 28 18:16:35 vmi2583988 uvicorn[1258312]: NameError: name 'app' is not defined
May 28 18:16:35 vmi2583988 systemd[1]: [0;1;39m[0;1;31m[0;1;39msemantic-api.service: Main process exited, code=exited, status=1/FAILURE[0m
May 28 18:16:35 vmi2583988 systemd[1]: [0;1;38;5;185m[0;1;39m[0;1;38;5;185msemantic-api.service: Failed with result 'exit-code'.[0m
May 28 18:16:35 vmi2583988 systemd[1]: Stopped semantic-api.service - Semantic Search API (Roam).
May 28 18:16:37 vmi2583988 systemd[1]: Starting semantic-api.service - Semantic Search API (Roam)...
May 28 18:16:37 vmi2583988 systemd[1]: Started semantic-api.service - Semantic Search API (Roam).
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "‚è≥ Waiting for API to boot..."
[?2004l‚è≥ Waiting for API to boot...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   sleep 3
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search# 
[?2004l[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   echo "üì° Hitting root route..."
[?2004lüì° Hitting root route...
[?2004h]0;root@vmi2583988: ~/roam-semantic-searchroot@vmi2583988:~/roam-semantic-search#   ROOT_OUTPUT=$(curl -s -w "\nHTTP_STATUS:%{http_code}" http://localhost:8000/)
[?2004lConnection to 207.180.227.18 closed.
